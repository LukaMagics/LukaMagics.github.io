---
title: "[Linux] 프로세스"

categories:
  - linux
tags:
  - [linux, process, 프로세스]

toc: true
toc_sticky: true
comments: true
use_math: true
date: 2022-06-06
last_modified_at: 2022-06-06
---

📌 **작성자 개발 환경** <br>
**OS** : Ubuntu <br>
**Language** : None<br>
**Tool** : None<br>
{: .notice--primary}

## 프로세스

- 프로세스(Process)란 리눅스 시스템에서 **메모리에 적재되어 실행되고 있는 모든 프로그램(실행되고 있는 프로그램)**
    - 여기서 프로그램이란 소스 코드의 집합체를 의미한다.
- 리눅스 프로세스의 특징
    - 모든 프로그램은 실행될 때 하나 이상의 프로세스를 갖는다
    - 병행적으로 실행이 가능하다
    - 부모, 자식 프로세스가 있게 된다(fork를 통한 프로세스 복사)
    - 커널에 의해 관리된다
    - 모든 프로세스에는 소유자가 있다
    - 프로세스마다 식별을 위한 ID가 부여된다(PID)
        - 리눅스에서 PID는 1번부터 1씩 증가하며 차례대로 부여된다
        - PID 1번은 init 프로세스, 2번은 kthreadd 프로세스(커널)가 실행됨
        - init 프로세스는 나머지 모든 시스템 프로세스의 부모 프로세스(모든 프로세스는 init 프로세스를 fork하여 만들어진다)
        - thread 프로세스는 모든 스레드(를 만드는 프로세스)의 부모 프로세스는 2번 프로세스가 부모 프로세스다

### 프로세스의 메모리 구성

- 실행되고 있는 프로그램인 프로세스는 메모리(RAM)에 저장되어있다. 아래는 프로세스 메모리의 구성이다

<p align="center"><img src="/assets/images/process_memory.png" width="90%" height="auto"></p>
<br>

- text, data, BSS, stack는 사용자 주소 공간. kernel은 사용자가 접근 불가한 커널 주소 공간
- **code(text)** 영역: 프로그램을 짜고 코드를 실행하면 코드가 명령화되어서 메모리의 코드 영역에 저장됨 (0x00: 가장 낮은 영역 또는 주소)
- **data** 영역: 초기화된 변수들이 저장되는 영역으로 전역 변수, 정적 변수, 배열, 구조체 등이 저장됨.
- **BSS** 영역: 초기화되지 않은 변수들이 저장되는 영역. (프로그램이 실행될 때 생성되고 프로그램 종료 시 반환됨)
- **heap** 영역: 동적으로 할당되는 변수들이 저장되는 영역 (낮은 주소->높은 주소로 쌓이는 구조).
- **stack** 영역: 프로그램이 자동으로 사용하는 임시 영역으로 함수 매개변수, 복귀 주소, 지역 변수와 같은 임시 데이터가 생성됨 (높은 주소->낮은 주소; FIFO)
- **kernel**: 0xFFF로 가장 높은 영역 또는 주소

### 프로세스 명령어

### ps 명령어

- `ps [option]`: 프로세스 목록 보기
    - `-e`: 현재 실행 중인 모든 프로세스 정보 출력
    - `-f`: 모든 정보 확인
    - `-a`: 실행중인 전체 사용자의 모든 프로세스 출력
    - `-u`: 프로세스를 실행한 사용자와 프로세스 시작 시간 등을 출력
    - `-x`: 터미널 제어 없이 프로세스 현황 보기
    - 참고
        - System V: `$ps -ef`
        - BSD: `ps aux`와 같이 `-` 없이 사용(=`ps -aux`)
    - `ps -ef`, `ps aux`, `ps -ef | grep [RE]` 등의 표현은 어떤 사용자가 CPU, Memory 등 자원을 많이 잡아먹는지 확인할 때 자주 사용됨

```
$ ps

PID     TTY         TIME    CMD ...
1245    pts/0   00:00:00    bash 
```
- 각 출력 내용의 의미
    - PID: Process ID. 프로세스 식별 번호
    - PPID: 부모 프로세스 ID (부모 프로세스가 없을 때 0)
    - TTY: Teletypes. 프로세스가 수행되는 터미널
    - TIME: 프로세스가 CPU를 사용한 시간(프로세스가 생성되고 얼마나 지났는지)
    - STIME: Start Time. 프로세스 시작 시간
    - CMD: 실행 명령어
    - C, CP (Sys V: C / BSD: CP): 짧은 기간 동안의 CPU 사용률 
    - %CPU: CPU 사용 비율 추정치(BSD), `ps -u`를 통해 출력
    - %MEM: 메모리 사용 비율 추정치(BSD), `ps -u`를 통해 출력
    - RSS: Resident Set Size. 실제 메모리 사용량
    - VSZ: 페이지(또는 K) 단위의 가상메모리 사용량
    - S, STAT: 현재 프로세스 상태 코드 (Sys V: S / BSD: STAT)

#### kill

- `kill [option] [PID]` : 프로세스 종료
    - `-l` (엘): 사용 가능한 시그널 목록을 출력
    - 자주 사용되는 시그널(option)
        - `-1` (일): 재실행 (SIGHUP)
        - `-9`: 강제종료(SIGKILL)
        - `-15`: 정상적으로 종료(SIGTERM)

- 사용 예시: `kill -15 26`